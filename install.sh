#!/bin/bash

# ‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Discord Server Manager
# ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô

echo "=========================================="
echo "üéÆ Discord Server Manager - Installation"
echo "=========================================="
echo ""

# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ Node.js ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
if ! command -v node &> /dev/null
then
    echo "‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö Node.js ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Node.js ‡∏Å‡πà‡∏≠‡∏ô"
    echo "‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà: https://nodejs.org/"
    exit 1
fi

echo "‚úÖ ‡∏û‡∏ö Node.js ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô: $(node -v)"
echo "‚úÖ ‡∏û‡∏ö npm ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô: $(npm -v)"
echo ""

# ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Backend
echo "üì¶ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Backend dependencies..."
cd backend
if npm install; then
    echo "‚úÖ ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Backend ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à"
else
    echo "‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Backend"
    exit 1
fi
cd ..
echo ""

# ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Frontend
echo "üì¶ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Frontend dependencies..."
cd frontend
if npm install; then
    echo "‚úÖ ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Frontend ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à"
else
    echo "‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Frontend"
    exit 1
fi
cd ..
echo ""

# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏ü‡∏•‡πå .env
echo "=========================================="
echo "‚öôÔ∏è  ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤"
echo "=========================================="
if [ -f "backend/.env" ]; then
    if grep -q "your_discord_bot_token_here" backend/.env; then
        echo "‚ö†Ô∏è  ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏ü‡∏•‡πå backend/.env"
        echo "   ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô DISCORD_TOKEN=your_discord_bot_token_here"
        echo "   ‡πÄ‡∏õ‡πá‡∏ô Token ‡∏Ç‡∏≠‡∏á Bot ‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏™‡∏£‡πâ‡∏≤‡∏á"
        echo ""
        echo "üìñ ‡∏ß‡∏¥‡∏ò‡∏µ‡∏™‡∏£‡πâ‡∏≤‡∏á Bot Token: ‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡πÉ‡∏ô INSTALLATION.md"
    else
        echo "‚úÖ ‡πÑ‡∏ü‡∏•‡πå .env ‡∏ñ‡∏π‡∏Å‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏•‡πâ‡∏ß"
    fi
else
    echo "‚ö†Ô∏è  ‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÑ‡∏ü‡∏•‡πå backend/.env"
    echo "   ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏•‡∏∞‡πÉ‡∏™‡πà Discord Bot Token"
fi
echo ""

echo "=========================================="
echo "‚úÖ ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå!"
echo "=========================================="
echo ""
echo "üìã ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ï‡πà‡∏≠‡πÑ‡∏õ:"
echo "1. ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏ü‡∏•‡πå backend/.env ‡πÉ‡∏™‡πà Discord Bot Token"
echo "2. ‡∏£‡∏±‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á: ./start.sh"
echo ""
echo "‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏±‡∏ô‡πÅ‡∏¢‡∏Å‡∏™‡πà‡∏ß‡∏ô:"
echo "  Backend:  ./start-backend.sh"
echo "  Frontend: ./start-frontend.sh"
echo ""
